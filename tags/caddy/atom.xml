<?xml version="1.0" encoding="UTF-8"?>
<feed xmlns="http://www.w3.org/2005/Atom" xml:lang="zh">
    <title> - caddy</title>
    <link href="https://linq.github.io/tags/caddy/atom.xml" rel="self" type="application/atom+xml"/>
    <link href="https://linq.github.io"/>
    <generator uri="https://www.getzola.org/">Zola</generator>
    <updated>2024-03-31T00:00:00+00:00</updated>
    <id>https://linq.github.io/tags/caddy/atom.xml</id>
    <entry xml:lang="zh">
        <title>ä½¿ç”¨Caddyé…ç½®å†…ç½‘HTTPS</title>
        <published>2024-03-31T00:00:00+00:00</published>
        <updated>2024-03-31T00:00:00+00:00</updated>
        <author>
          <name>Unknown</name>
        </author>
        <link rel="alternate" href="https://linq.github.io/posts/caddy/" type="text/html"/>
        <id>https://linq.github.io/posts/caddy/</id>
        
        <content type="html">&lt;p&gt;&lt;img src=&quot;https:&#x2F;&#x2F;user-images.githubusercontent.com&#x2F;1128849&#x2F;210187356-dfb7f1c5-ac2e-43aa-bb23-fc014280ae1f.svg&quot; alt=&quot;Caddy&quot; &#x2F;&gt;&lt;&#x2F;p&gt;
&lt;p&gt;NAS ä¸Šé€šè¿‡ Docker éƒ¨ç½²çš„æœåŠ¡è¶Šæ¥è¶Šå¤šï¼Œæ¯æ¬¡éƒ½æ˜¯é€šè¿‡ç‹¬ç«‹çš„ç«¯å£å¼€æ”¾å‡ºæ¥ï¼Œè™½ç„¶ä¹Ÿå¯ä»¥ç”¨ï¼Œä½†æ˜¯æ¯æ¬¡éƒ½éœ€è¦ IP æ„Ÿè§‰å¾ˆéº»çƒ¦ã€‚è¿™å‘¨åˆæäº†ä¸¤ä¸ªæ–°çš„æœåŠ¡éƒ¨ç½²ä¸Šå»ï¼Œå°¤å…¶å…¶ä¸­ä¸€ä¸ªé€šè¿‡ IP æ¥ä½¿ç”¨è¿˜æœ‰ç‚¹é—®é¢˜ï¼Œå°±è°ƒç ”äº†ä¸‹æ€ä¹ˆæŠ˜è…¾å†…ç½‘çš„HTTPSã€‚&lt;&#x2F;p&gt;
&lt;p&gt;é¦–å…ˆæƒ³åˆ°çš„å°±æ˜¯ NGINXï¼Œå·¥ä½œä¸­ç”¨çš„æ¯”è¾ƒå¤šï¼Œä¹‹å‰ä¸ºäº†éƒ¨ç½² Bitwarden ä¹Ÿå·²ç»éƒ¨ç½²äº†ã€‚ä¸è¿‡å†…å¿ƒæœ‰ç‚¹æ‹’ç»ï¼Œæ€»æ„Ÿè§‰ NGINX æœ‰ç‚¹å¤ªé‡äº†ï¼Œä¹Ÿå¯èƒ½æ˜¯å·¥ä½œä¸­ç”¨çš„æ¯”è¾ƒå¤šï¼Œå¯¹å®ƒçš„è¯­æ³•æ„Ÿè§‰ä¸æ˜¯ç‰¹åˆ«å–œæ¬¢ï¼Œå°¤å…¶æ˜¯è½¬å‘æŒ‡ä»¤å„ç§æ½œè§„åˆ™ï¼Œå¾ˆå®¹æ˜“çŠ¯é”™ã€‚æŠ±ç€æŠ˜è…¾ä¸€ä¸‹çš„å¿ƒæ€ï¼Œç”¨ Google å’Œ GPT æœäº†ä¸‹å¯é€‰çš„æ–¹æ¡ˆï¼Œå‘ç° Google å’Œ GPT éƒ½æ¨è Caddyã€‚ç®€å•æŸ¥äº†ä¸€äº›èµ„æ–™ï¼Œå‘ç°è·Ÿé…ç½®æ–¹å¼è·Ÿ NGINX æŒºåƒçš„ï¼Œè€Œä¸”è²Œä¼¼æ›´è½»é‡çº§ï¼Œé…ç½®ä¹Ÿç®€åŒ–äº†ä¸å°‘ã€‚&lt;&#x2F;p&gt;
&lt;p&gt;æ¥ä¸‹æ¥ç›´å¥”ä¸»é¢˜çœ‹ä¸‹ HTTPS æ€ä¹ˆé…ç½®ï¼Œæˆ‘èƒ½æƒ³åˆ°çš„å°±æ˜¯è‡ªç­¾åè¯ä¹¦çš„æ–¹å¼ï¼Œæ‰€ä»¥é‡ç‚¹çœ‹äº†ç›¸å…³çš„èµ„æ–™ï¼ŒCaddy ä¹Ÿçš„ç¡®æ”¯æŒã€‚&lt;&#x2F;p&gt;
&lt;p&gt;é¦–å…ˆæ˜¯è¯ä¹¦ç”Ÿæˆï¼š&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; style=&quot;background-color:#2b303b;color:#c0c5ce;&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;openssl&lt;&#x2F;span&gt;&lt;span&gt; req&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt; -x509 -nodes -days&lt;&#x2F;span&gt;&lt;span&gt; 365&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt; -newkey&lt;&#x2F;span&gt;&lt;span&gt; rsa:2048&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt; -keyout &lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;n1.key&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt; -out &lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;n1.crt&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt; -subj &lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&#x2F;CN=*.n1.to&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;ç„¶åä¿®æ”¹ Caddyfile æ¥ä½¿ç”¨è¯ä¹¦ï¼š&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; style=&quot;background-color:#2b303b;color:#c0c5ce;&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;auto_https&lt;&#x2F;span&gt;&lt;span&gt; off
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;log &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;        output file &#x2F;data&#x2F;caddy.log
&lt;&#x2F;span&gt;&lt;span&gt;        level INFO
&lt;&#x2F;span&gt;&lt;span&gt;        format console {
&lt;&#x2F;span&gt;&lt;span&gt;            time_local
&lt;&#x2F;span&gt;&lt;span&gt;            time_format wall_milli
&lt;&#x2F;span&gt;&lt;span&gt;        }
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;*.n1.to &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    tls &#x2F;ssl&#x2F;n1.crt &#x2F;ssl&#x2F;n1.key
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;https:&#x2F;&#x2F;chat.n1.to &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    reverse_proxy * chatgpt:3000
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;https:&#x2F;&#x2F;vault.n1.to &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    reverse_proxy * vaultwarden:80
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;é…ç½®ååŸºæœ¬æ»¡è¶³éœ€æ±‚ï¼Œèƒ½é€šè¿‡æµè§ˆå™¨ç›´æ¥è®¿é—®å¯¹åº”çš„åŸŸåï¼Œå„ä¸ªæœåŠ¡ä¹Ÿèƒ½æ­£å¸¸ä½¿ç”¨ã€‚ä½†æ˜¯æœ‰ä¸€ç‚¹è®©æˆ‘æœ‰ç‚¹éš¾å—ï¼ŒChrome å¯¹äºè‡ªç­¾åè¯ä¹¦æ¯æ¬¡é‡æ–°æ‰“å¼€çš„æ—¶å€™éƒ½ä¼šæç¤ºä¸å®‰å…¨ï¼Œæ¯æ¬¡éƒ½éœ€è¦ç‚¹å‡»ä¸€æ¬¡ç¡®è®¤æ‰èƒ½ä½¿ç”¨ã€‚&lt;&#x2F;p&gt;
&lt;p&gt;è¿™æ—¶å€™æ±‚åŠ©ä¸‡èƒ½çš„GPTï¼Œ&lt;code&gt;caddyæœ‰å…¶å®ƒæ–¹å¼æ”¯æŒå†…éƒ¨åŸŸåhttpså—&lt;&#x2F;code&gt;ï¼ŒGPT ç»™å‡ºçš„ç­”æ¡ˆä¸­æœ‰ä¸€ä¸ª&lt;strong&gt;å†…éƒ¨CAé¢å‘çš„è¯ä¹¦&lt;&#x2F;strong&gt;çš„æ–¹æ¡ˆï¼Œä¸“é—¨å»å®˜ç½‘äº†è§£äº†ä¸‹ï¼Œå‘ç° Caddy å¯ä»¥é€šè¿‡ tls internal çš„æ–¹å¼ï¼Œç›´æ¥ä½¿ç”¨å†…ç½®çš„PKI æ¥é¢å‘è¯ä¹¦ï¼Œè€Œä¸”é…ç½®éå¸¸çš„æ–¹ä¾¿ï¼Œåªéœ€è¦å£°æ˜ä¸€ä¸ª tls internalï¼Œå…¶å®ƒçš„ Caddy å¸®ä½ æå®šã€‚&lt;&#x2F;p&gt;
&lt;p&gt;ç„¶åå°±æ˜¯ç¬¬äºŒç‰ˆçš„ Caddyfileï¼š&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; style=&quot;background-color:#2b303b;color:#c0c5ce;&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;log &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;        output file &#x2F;data&#x2F;caddy.log
&lt;&#x2F;span&gt;&lt;span&gt;        level INFO
&lt;&#x2F;span&gt;&lt;span&gt;        format console {
&lt;&#x2F;span&gt;&lt;span&gt;            time_local
&lt;&#x2F;span&gt;&lt;span&gt;            time_format wall_milli
&lt;&#x2F;span&gt;&lt;span&gt;        }
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;*.n1.to &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    tls internal {
&lt;&#x2F;span&gt;&lt;span&gt;        on_demand
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    @chat host chat.n1.to
&lt;&#x2F;span&gt;&lt;span&gt;    handle @chat {
&lt;&#x2F;span&gt;&lt;span&gt;        reverse_proxy * chatgpt:3000
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    @vault host vault.n1.to
&lt;&#x2F;span&gt;&lt;span&gt;    handle @vault {
&lt;&#x2F;span&gt;&lt;span&gt;        reverse_proxy * vaultwarden:80
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    handle {
&lt;&#x2F;span&gt;&lt;span&gt;        abort
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;è¿™é‡Œçš„æ ¸å¿ƒå°±æ˜¯ &lt;code&gt;tls internal&lt;&#x2F;code&gt; è¿™éƒ¨åˆ†ï¼ŒCaddy åˆ¤æ–­æ˜¯å†…éƒ¨tls ä¹‹åï¼Œä¼šåœ¨è¯·æ±‚æŒ‡å®šåŸŸåçš„æ—¶å€™ï¼ˆæ¯”å¦‚ &lt;code&gt;chat.n1.to&lt;&#x2F;code&gt;ï¼‰ï¼Œå†…éƒ¨é€šè¿‡ local çš„ ca æ¥è¯·æ±‚è¯ä¹¦å¹¶ä¸‹å‘ç»™æµè§ˆå™¨ï¼Œåªè¦ä½ æŠŠ Caddy çš„ root.crt çš„æ ¹è¯ä¹¦å®‰è£…ï¼Œæ‰€æœ‰Caddy é¢å‘çš„å­è¯ä¹¦éƒ½æ˜¯è¢«ä¿¡ä»»çš„ã€‚è¿™ä¸ªæ—¶å€™ä½ æ‰“å¼€æŒ‡å®šçš„åŸŸåå°±ä¸ä¼šæç¤ºä¸å®‰å…¨ï¼Œè€Œä¸”åœ°å€æ ä¸Šçš„ğŸ”ä¹Ÿæ˜¯ç»¿è‰²çš„ã€‚&lt;&#x2F;p&gt;
&lt;p&gt;è¿™é‡Œè¡¥å……ä¸‹Mac ä¸Šå¦‚ä½•å®‰è£… &lt;code&gt;root.crt&lt;&#x2F;code&gt;ï¼š&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; style=&quot;background-color:#2b303b;color:#c0c5ce;&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;sudo&lt;&#x2F;span&gt;&lt;span&gt; security add-trusted-cert&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt; -d -k&lt;&#x2F;span&gt;&lt;span&gt; &#x2F;Library&#x2F;Keychains&#x2F;System.keychain &#x2F;path&#x2F;to&#x2F;root.crt
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;ç„¶åè¿™ä¸ª &lt;code&gt;root.crt&lt;&#x2F;code&gt; å“ªé‡Œæ¥ï¼Œåœ¨ç±»Unix çš„ç¯å¢ƒä¸­ï¼Œå¯ä»¥åœ¨ &lt;code&gt;$HOME&#x2F;.local&#x2F;share&#x2F;caddy&#x2F;pki&#x2F;authorities&#x2F;local&#x2F;root.crt&lt;&#x2F;code&gt; ä¸­æ‰¾åˆ°ã€‚&lt;&#x2F;p&gt;
&lt;p&gt;æ•´ä½“æŠ˜è…¾å®Œæ„Ÿè§‰è¿˜æ˜¯å¾ˆæ»¡æ„çš„ï¼Œè€Œä¸”å‘ç°äº† Caddy è¿™ä¹ˆä¸€ä¸ªç¥å™¨ï¼Œåç»­æƒ³åšä¸€ä¸ªç®€å•çš„åå‘ä»£ç†å®Œå…¨å¯ä»¥æ‹¿è¿‡æ¥ç”¨ã€‚è€Œä¸” Caddy æœ‰ä¸€ä¸ªéå¸¸æ–¹ä¾¿çš„åŠŸèƒ½ï¼Œå¦‚æœä½ æœ‰ä¸€ä¸ªå¤–ç½‘åŸŸåï¼Œå®Œæˆä¸éœ€è¦è‡ªå·±ç”³è¯·tls è¯ä¹¦ï¼ŒCaddy ç›´æ¥é›†æˆäº†Letâ€™s Encryptï¼Œè‡ªåŠ¨å¸®ä½ ç”³è¯·å’Œç»­ç­¾è¯ä¹¦ï¼Œé…ç½®ä¹Ÿå¾ˆç®€å•ï¼Œæ„Ÿè§‰è¿™æ‰æ˜¯æ–°ç½‘å…³åº”è¯¥æœ‰çš„æ ·å­ã€‚&lt;&#x2F;p&gt;
&lt;p&gt;é…ç½®å‚è€ƒï¼š&lt;a rel=&quot;noopener&quot; target=&quot;_blank&quot; href=&quot;https:&#x2F;&#x2F;caddyserver.com&#x2F;docs&#x2F;caddyfile&quot;&gt;caddyfile&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
</content>
        
    </entry>
</feed>
